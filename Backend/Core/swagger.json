{"openapi":"3.1.0","info":{"title":"FastAPI","version":"0.1.0"},"paths":{"/user":{"post":{"tags":["User"],"summary":"Create User","description":"Create user","operationId":"create_user_user_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserResponse"}}}},"409":{"status_code":409,"description":409,"content":{"application/json":{"example":{"detail":["User already exists"]}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/user/confirm":{"post":{"tags":["User"],"summary":"Confirm User Email","description":"Confirm user email after registration with code","operationId":"confirm_user_email_user_confirm_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfirmUserEmailRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"404":{"status_code":404,"description":404,"content":{"application/json":{"example":{"detail":["User confirmation code not found"]}}}},"400":{"status_code":400,"description":400,"content":{"application/json":{"example":{"detail":["Incorrect confirmation code"]}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/user/confirm/resend-email":{"post":{"tags":["User"],"summary":"Resend User Email","description":"Resend confirmation code to user email","operationId":"resend_user_email_user_confirm_resend_email_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResendUserConfirmationCodeRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/login":{"post":{"tags":["Auth"],"summary":"Auth User","description":"Authenticate user","operationId":"auth_user_auth_login_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateUserRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"403":{"status_code":403,"description":403,"content":{"application/json":{"example":{"detail":["The user's identity has not been confirmed"]}}}},"404":{"status_code":404,"description":404,"content":{"application/json":{"example":{"detail":["Incorrect username or password"]}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/auth/refresh":{"patch":{"tags":["Auth"],"summary":"Create New Token Pair","description":"Get new access token","operationId":"create_new_token_pair_auth_refresh_patch","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"401":{"status_code":401,"description":401,"content":{"application/json":{"example":{"detail":["Not authorized"]}}}}},"security":[{"JwtRefreshBearer":[]},{"JwtRefreshCookie":[]}]}},"/auth/logout":{"post":{"tags":["Auth"],"summary":"Logout","description":"Logout user","operationId":"logout_auth_logout_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"401":{"status_code":401,"description":401,"content":{"application/json":{"example":{"detail":["Not authorized"]}}}}},"security":[{"JwtRefreshBearer":[]},{"JwtRefreshCookie":[]}]}},"/auth/test":{"get":{"tags":["Auth"],"summary":"Test","description":"test","operationId":"test_auth_test_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"401":{"status_code":401,"description":401,"content":{"application/json":{"example":{"detail":["Not authorized","Token time expired","Wrong token"]}}}}},"security":[{"JwtAccessBearer":[]},{"JwtAccessCookie":[]}]}},"/prompt/generate-s3-presigned-post":{"post":{"tags":["Prompt"],"summary":"Generate S3 Presigned Post","description":"Generate presigned post url and data to upload to S3","operationId":"generate_s3_presigned_post_prompt_generate_s3_presigned_post_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PresignedPostResponse"}}}}},"security":[{"JwtAccessBearer":[]},{"JwtAccessCookie":[]}]}},"/prompt/confirm":{"post":{"tags":["Prompt"],"summary":"Confirm","description":"Start to process the prompt","operationId":"confirm_prompt_confirm_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConfirmPromptRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Prompt"}}}},"400":{"status_code":400,"description":400,"content":{"application/json":{"example":{"detail":["Invalid prompt path"]}}}},"404":{"status_code":404,"description":404,"content":{"application/json":{"example":{"detail":["Raw prompt now not found. Try to upload again"]}}}},"409":{"status_code":409,"description":409,"content":{"application/json":{"example":{"detail":["Raw prompt already exists. Maybe, you need to get the new presigned link and upload image"]}}}},"500":{"status_code":500,"description":500,"content":{"application/json":{"example":{"detail":["Sorry. Now we can't process your request. Try again later"]}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"JwtAccessBearer":[]},{"JwtAccessCookie":[]}]}},"/prompt":{"get":{"tags":["Prompt"],"summary":"Get Prompt Page","description":"Get prompts with pagination","operationId":"get_prompt_page_prompt_get","security":[{"JwtAccessBearer":[]},{"JwtAccessCookie":[]}],"parameters":[{"name":"size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"exclusiveMinimum":0,"description":"Prompts quantity, no more than 100","default":30,"title":"Size"},"description":"Prompts quantity, no more than 100"},{"name":"created_at","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Timestamp-ISO cursor for the next page","title":"Created At"},"description":"Timestamp-ISO cursor for the next page"},{"name":"prompt_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"description":"Prompt uuid","title":"Prompt Id"},"description":"Prompt uuid"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Prompt"},"title":"Response Get Prompt Page Prompt Get"}}}},"404":{"status_code":404,"description":404,"content":{"application/json":{"example":{"detail":["Prompt(s) not found"]}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/prompt/generate-s3-presigned-get":{"post":{"tags":["Prompt"],"summary":"Generate S3 Presigned Get","description":"Generate presigned get url for downloading image(s)","operationId":"generate_s3_presigned_get_prompt_generate_s3_presigned_get_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PresignedGetRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/PresidnedGetResponse"},"type":"array","title":"Response Generate S3 Presigned Get Prompt Generate S3 Presigned Get Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"JwtAccessBearer":[]},{"JwtAccessCookie":[]}]}},"/prompt/test_send_to_rabbit":{"post":{"tags":["Prompt"],"summary":"Test","operationId":"test_prompt_test_send_to_rabbit_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"ConfirmPromptRequest":{"properties":{"key_path":{"type":"string","title":"Key Path","description":"Key path to object","examples":["raw/user_{some-id}/prompt_{some-id}"]}},"type":"object","required":["key_path"],"title":"ConfirmPromptRequest"},"ConfirmUserEmailRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"User email","examples":["example@mail.com"]},"confirmation_code":{"type":"string","maxLength":6,"minLength":6,"format":"password","title":"Confirmation Code","description":"Confirmation email code","writeOnly":true,"examples":["357298"]}},"type":"object","required":["email","confirmation_code"],"title":"ConfirmUserEmailRequest"},"CreateUserRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"User email","examples":["example@mail.com"]},"password":{"type":"string","maxLength":64,"minLength":6,"format":"password","title":"Password","description":"User password must contain 6-64 symbols, minimum 1 uppercase letter and 1 digit","writeOnly":true,"examples":["SecurePass123"]}},"type":"object","required":["email","password"],"title":"CreateUserRequest"},"CreateUserResponse":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"User email","examples":["example@mail.com"]},"role_name":{"type":"string","title":"Role Name","default":"DEFAULT"}},"type":"object","required":["email"],"title":"CreateUserResponse"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"PresidnedGetResponse":{"properties":{"prompt_id":{"type":"string","title":"Prompt Id","description":"Prompt id","examples":["some-id"]},"url":{"type":"string","title":"Url","examples":["https://example.com"]}},"type":"object","required":["prompt_id","url"],"title":"PresidnedGetResponse"},"PresignedGetRequest":{"properties":{"prompts":{"items":{"$ref":"#/components/schemas/PromptWithStatus"},"type":"array","title":"Prompts"}},"type":"object","required":["prompts"],"title":"PresignedGetRequest"},"PresignedPostFields":{"properties":{"Content-Type":{"type":"string","title":"Content-Type","examples":["image/"]},"key":{"type":"string","title":"Key","description":"Key path to object","examples":["raw/user_{some-id}/prompt_{some-id}"]},"AWSAccessKeyId":{"type":"string","title":"Awsaccesskeyid","examples":["user"]},"policy":{"type":"string","title":"Policy","examples":["policy"]},"signature":{"type":"string","title":"Signature","examples":["signature"]}},"type":"object","required":["Content-Type","key","AWSAccessKeyId","policy","signature"],"title":"PresignedPostFields"},"PresignedPostResponse":{"properties":{"url":{"type":"string","title":"Url","examples":["http://example.com"]},"fields":{"$ref":"#/components/schemas/PresignedPostFields"}},"type":"object","required":["url","fields"],"title":"PresignedPostResponse"},"Prompt":{"properties":{"id":{"type":"string","format":"uuid","title":"Id","description":"Unique user prompt id in database","examples":["some-id"]},"user_id":{"type":"integer","exclusiveMinimum":0.0,"title":"User Id","description":"User ID","examples":[1]},"prompt_id":{"type":"string","title":"Prompt Id","description":"Prompt id","examples":["some-id"]},"raw_key":{"type":"string","title":"Raw Key","description":"Key path to object","examples":["raw/user_{some-id}/prompt_{some-id}"]},"result_key":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Result Key","description":"Key path to object","examples":["raw/user_{some-id}/prompt_{some-id}"]},"status":{"$ref":"#/components/schemas/PromptStatus","description":"Prompt status","examples":["pending","success","error","cancelled"]},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Prompt creation time","examples":[""]},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Prompt status update time","examples":[""]}},"type":"object","required":["id","user_id","prompt_id","raw_key","result_key","status","created_at","updated_at"],"title":"Prompt"},"PromptStatus":{"type":"string","enum":["pending","success","error","cancelled"],"title":"PromptStatus"},"PromptWithStatus":{"properties":{"prompt_id":{"type":"string","title":"Prompt Id"},"status":{"$ref":"#/components/schemas/PromptStatus","description":"Prompt status","examples":["pending","success","error","cancelled"]}},"type":"object","required":["prompt_id","status"],"title":"PromptWithStatus"},"ResendUserConfirmationCodeRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"User email","examples":["example@mail.com"]}},"type":"object","required":["email"],"title":"ResendUserConfirmationCodeRequest"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"JwtRefreshBearer":{"type":"http","scheme":"bearer"},"JwtRefreshCookie":{"type":"apiKey","in":"cookie","name":"refresh_token"},"JwtAccessBearer":{"type":"http","scheme":"bearer"},"JwtAccessCookie":{"type":"apiKey","in":"cookie","name":"access_token"}}}}